{
  "meta": {
    "featureId": "feature-001-support-ticket",
    "version": "1.0.0"
  },
  "feature": "feature-001-support-ticket",
  "scenarios": [
    {
      "id": "create_ticket_happy_path",
      "title": "User creates a valid support ticket",
      "type": "happy-path"
    },
    {
      "id": "create_ticket_missing_subject",
      "title": "Ticket creation fails when subject is missing",
      "type": "validation"
    },
    {
      "id": "create_ticket_invalid_priority",
      "title": "Ticket creation fails when priority is invalid",
      "type": "validation"
    },
    {
      "id": "create_ticket_duplicate_subject_same_day",
      "title": "Ticket creation fails when subject already exists for the same day",
      "type": "validation"
    },
    {
      "id": "create_ticket_high_priority_visible_immediately",
      "title": "HIGH priority ticket visible immediately after creation",
      "type": "happy-path"
    },
    {
      "id": "create_ticket_limit_3_per_day",
      "title": "Ticket creation fails when user exceeds 3 tickets in one day",
      "type": "validation"
    },
    {
      "id": "ticket_priority_completion_order",
      "title": "HIGH priority tickets are completed before LOW priority tickets",
      "type": "happy-path"
    },
    {
      "id": "br_a_ticket_with_priority_high_must_always_be_visible_immediate",
      "title": "Business rule: A ticket with priority HIGH must always be visible immediately after creation.",
      "type": "validation"
    },
    {
      "id": "br_ticket_subject_must_be_unique_per_day_business_constraint",
      "title": "Business rule: Ticket subject must be unique per day (business constraint).",
      "type": "validation"
    },
    {
      "id": "br_user_can_only_add_3_tickets_per_day",
      "title": "Business rule: User can only add 3 tickets per day",
      "type": "validation"
    },
    {
      "id": "br_a_ticket_with_priority_high_must_always_be_completed_before_",
      "title": "Business rule: A ticket with priority HIGH must always be completed before a ticket with priority LOW",
      "type": "validation"
    }
  ],
  "flows": [
    {
      "id": "FLOW-001",
      "name": "Happy path â€” create ticket",
      "preconditions": [
        "User authenticated",
        "API available"
      ],
      "steps": [
        {
          "actor": "user",
          "action": "Navigate to /tickets/new",
          "expected": "Form shown with subject/description/priority, submit disabled"
        },
        {
          "actor": "user",
          "action": "Enter subject 'Cannot login to portal'",
          "expected": "Subject valid"
        },
        {
          "actor": "user",
          "action": "Enter description with >= 20 characters",
          "expected": "Description valid"
        },
        {
          "actor": "user",
          "action": "Select priority HIGH",
          "expected": "Priority valid, submit enabled"
        },
        {
          "actor": "user",
          "action": "Click Submit",
          "expected": "Loading indicator shown",
          "apiCalls": [
            "POST /api/tickets"
          ]
        },
        {
          "actor": "system",
          "action": "Return 201 CreateTicketResponse",
          "expected": "Success view shows ticketNumber and status OPEN"
        }
      ],
      "variants": [
        {
          "type": "negative",
          "name": "Subject too short",
          "steps": [
            {
              "actor": "user",
              "action": "Enter subject 'abc'",
              "expected": "Field error shown, submit disabled"
            }
          ]
        },
        {
          "type": "negative",
          "name": "Server error 500",
          "steps": [
            {
              "actor": "system",
              "action": "Return 500 ApiError with correlationId",
              "expected": "UI shows generic error with correlationId"
            }
          ]
        },
        {
          "type": "negative",
          "name": "User exceeds 3 tickets per day",
          "steps": [
            {
              "actor": "system",
              "action": "Reject ticket creation after 3 tickets created in same day",
              "expected": "400 with field error on limit"
            }
          ]
        },
        {
          "type": "negative",
          "name": "User exceeds 3 tickets per day",
          "steps": [
            {
              "actor": "system",
              "action": "Reject ticket creation after 3 tickets created in same day",
              "expected": "400 with field error on limit"
            }
          ]
        },
        {
          "type": "negative",
          "name": "User exceeds 3 tickets per day",
          "steps": [
            {
              "actor": "system",
              "action": "Reject ticket creation after 3 tickets created in same day",
              "expected": "400 with field error on limit"
            }
          ]
        },
        {
          "type": "negative",
          "name": "LOW completed before HIGH is not allowed",
          "steps": [
            {
              "actor": "system",
              "action": "Attempt to complete a LOW ticket while a HIGH ticket is still open",
              "expected": "Operation rejected (409 or 400) with code PRIORITY_ORDER_VIOLATION (or similar)"
            }
          ]
        }
      ]
    }
  ]
}
