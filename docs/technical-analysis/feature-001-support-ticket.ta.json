{
  "meta": {
    "featureId": "feature-001-support-ticket",
    "title": "Support Ticket Create",
    "version": "1.0.0",
    "createdAt": "2026-02-02"
  },
  "scope": {
    "inScope": [
      "Create ticket",
      "Validation",
      "Persist SupportTicket",
      "Return ticketNumber + status"
    ],
    "outOfScope": [
      "Update/close",
      "Attachments",
      "Email notifications"
    ]
  },
  "assumptions": [
    "Endpoint requires authenticated user (placeholder).",
    "Use JPA with relational database.",
    "Correlation id via X-Correlation-Id header or generated.",
    "Priority processing order: HIGH > MEDIUM > LOW (REQ-010)",
    "Priority processing order: HIGH > MEDIUM > LOW (REQ-010)"
  ],
  "openQuestions": [
    "Link ticket to userId?",
    "Existing global error response standard?"
  ],
  "requirements": [
    {
      "id": "REQ-001",
      "text": "User can create ticket with subject, description, priority.",
      "priority": "must"
    },
    {
      "id": "REQ-002",
      "text": "Subject required min 5 max 120.",
      "priority": "must"
    },
    {
      "id": "REQ-003",
      "text": "Description required min 20 max 2000.",
      "priority": "must"
    },
    {
      "id": "REQ-004",
      "text": "Priority required LOW/MEDIUM/HIGH.",
      "priority": "must"
    },
    {
      "id": "REQ-005",
      "text": "Success returns ticketNumber and status OPEN.",
      "priority": "must"
    },
    {
      "id": "REQ-006",
      "text": "Validation errors return field-specific errors.",
      "priority": "must"
    },
    {
      "id": "REQ-007",
      "text": "Server errors show generic message with correlation id.",
      "priority": "must"
    },
    {
      "id": "REQ-008",
      "text": "Subject must be unique per day.",
      "priority": "must"
    },
    {
      "id": "REQ-009",
      "text": "User can create at most 3 tickets per day.",
      "priority": "must"
    },
    {
      "id": "REQ-010",
      "text": "Tickets with priority HIGH must be completed before tickets with priority LOW.",
      "priority": "must"
    }
  ],
  "domain": {
    "entities": [
      {
        "name": "SupportTicket",
        "fields": [
          {
            "name": "id",
            "type": "uuid"
          },
          {
            "name": "ticketNumber",
            "type": "string",
            "constraints": [
              "unique"
            ]
          },
          {
            "name": "subject",
            "type": "string",
            "constraints": [
              "min:5",
              "max:120",
              "uniquePerDay:true"
            ],
            "testCases": [
              "empty",
              "too_short",
              "too_long"
            ]
          },
          {
            "name": "description",
            "type": "string",
            "constraints": [
              "min:20",
              "max:2000"
            ],
            "testCases": [
              "empty",
              "too_short",
              "too_long"
            ]
          },
          {
            "name": "priority",
            "type": "enum:LOW|MEDIUM|HIGH",
            "testCases": [
              "missing",
              "invalid_value"
            ]
          },
          {
            "name": "status",
            "type": "enum:OPEN"
          },
          {
            "name": "createdAt",
            "type": "instant"
          }
        ]
      }
    ]
  },
  "api": {
    "errorFormat": {
      "type": "ApiError",
      "fields": [
        "correlationId",
        "code",
        "message",
        "fieldErrors"
      ]
    },
    "endpoints": [
      {
        "method": "POST",
        "path": "/api/tickets",
        "summary": "Create support ticket",
        "request": {
          "bodySchemaRef": "CreateTicketRequest",
          "validationRules": [
            "subject min 5 max 120",
            "description min 20 max 2000",
            "priority in LOW|MEDIUM|HIGH"
          ]
        },
        "responses": [
          {
            "status": 201,
            "bodySchemaRef": "CreateTicketResponse"
          },
          {
            "status": 400,
            "bodySchemaRef": "ApiError"
          },
          {
            "status": 500,
            "bodySchemaRef": "ApiError"
          }
        ],
        "auth": "authenticated"
      }
    ]
  },
  "backend": {
    "modules": [
      {
        "name": "tickets",
        "classes": [
          {
            "name": "TicketController",
            "responsibility": "REST endpoint mapping"
          },
          {
            "name": "TicketService",
            "responsibility": "Business logic"
          },
          {
            "name": "TicketNumberGenerator",
            "responsibility": "Generate ticket number"
          },
          {
            "name": "SupportTicketRepository",
            "responsibility": "Persistence"
          },
          {
            "name": "GlobalExceptionHandler",
            "responsibility": "Error handling"
          }
        ]
      }
    ]
  },
  "frontend": {
    "routes": [
      "/tickets/new"
    ],
    "components": [
      "TicketCreatePage",
      "TicketForm"
    ]
  },
  "tests": {
    "unit": [
      "TicketValidationTest",
      "TicketServiceTest"
    ],
    "integration": [
      "TicketControllerIT"
    ],
    "e2e": []
  },
  "traceability": [
    {
      "reqId": "REQ-009",
      "backendRefs": [
        "TicketService"
      ],
      "frontendRefs": [
        "TicketForm"
      ],
      "testRefs": [
        "Feature001SupportTicketGeneratedIT"
      ]
    }
  ],
  "generatedTests": {
    "validationMatrix": {
      "SupportTicket.subject": [
        "empty",
        "too_short",
        "too_long"
      ],
      "SupportTicket.description": [
        "empty",
        "too_short",
        "too_long"
      ],
      "SupportTicket.priority": [
        "missing",
        "invalid_value"
      ]
    }
  }
}
